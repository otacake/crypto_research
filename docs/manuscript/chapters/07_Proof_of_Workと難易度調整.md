# 第7章: Proof of Work と難易度調整

第6章で、履歴を追試可能な形で固定する骨格を作りました。本章の問いは、その骨格をどのように改ざんしにくくするかです。中心になるのは Proof of Work（PoW）と難易度調整です。結論を先に置くと、PoWは履歴改変に実コストを課し、難易度調整はそのコスト環境を時間変化の中で維持する制御機構です。この二つを分けて理解すると、安全性評価の軸が明確になります。[一次:S-CH07-001][一次:S-CH06-001]

## 1. PoWの目的

最初に日常導入を置きます。紙の申請書を後から書き換えられないようにするには、訂正のたびに重い手続きが必要な制度を設ける方法があります。PoWはこの発想を計算資源で実装したものです。記録を作るときに計算労力を要求し、後から過去を書き換えるとその労力を遡って払い直させます。[一次:S-CH07-001]

PoW課題の要点は「見つけるのは難しいが、検証は容易」であることです。この非対称性により、提案者はコストを払い、検証者は比較的低コストで正否を確認できます。順序共有システムでは、参加者全員が重い計算をするのではなく、提案コストを集中させ検証コストを薄く広げる設計が実務上重要です。[一次:S-CH07-001]

素朴案として「署名検証があるから改ざんは防げる」と考えるのは不十分です。署名検証は取引権限の確認であり、履歴差し替えの総コストを直接増やしません。履歴連鎖を遡って置き換える攻撃を重くするには、ブロック提案自体に作成コストを埋め込む必要があります。PoWはこの役割を担います。[一次:S-CH07-001][一次:S-CH06-001]

破綻例1は、PoWがない履歴で、攻撃者が過去から高速に再計算し直して履歴差し替えを狙うケースです。破綻例2は、PoWはあるが難度が低すぎ、攻撃者が短時間で追随できるケースです。どちらも「改ざんしにくい履歴」という目的を満たしません。PoWは有無だけでなく、実効難度で評価する必要があります。[一次:S-CH07-001]

この破綻から橋渡しされる要件は三つです。要件1は提案コストの明確化、要件2は検証コストの軽量化、要件3は遡及改変時のコスト累積です。要件3が弱いと、最新だけ守っても過去改ざんで履歴説明が崩れます。要件2が弱いと、ノード参加コストが上がり過ぎて検証主体が減ります。三要件の均衡が必要です。[一次:S-CH07-001]

## 2. 難易度

PoWを導入しても、ネットワーク全体の計算能力は固定ではありません。新規設備、電力価格、季節要因、運用停止などで総計算能力は動きます。難易度が固定だと、能力上昇時はブロックが早く出すぎ、能力低下時は遅すぎます。どちらも収束運用に悪影響です。[一次:S-CH07-001]

難易度（difficulty）は、PoW課題をどれだけ解きにくくするかを調整する変数です。目標は、ブロック生成間隔を理想値へ近づけ、分岐頻度や遅延負荷を管理可能な範囲に保つことです。ここでの「安定」は停止でも高速化でもなく、想定帯に戻す制御です。[一次:S-CH07-001]

素朴案として「最初から強い難易度に固定すれば安全」と考えると、環境変化に対応できません。計算能力が倍増した環境では固定難易度が相対的に弱まり、能力が急減した環境では固定難易度が過重になります。難易度は定数ではなく、環境変動に追随する制御量として運用する必要があります。[一次:S-CH07-001]

破綻例1は、能力急増で生成間隔が短縮し、同時発見と分岐が増えるケースです。破綻例2は、能力低下で生成間隔が伸長し、取引確定待ちが長引くケースです。前者は合意収束の負荷増、後者は利用者体験の悪化を生みます。難易度調整の目的は、この両側破綻を緩和することです。[一次:S-CH07-001][一次:S-CH08-001]

橋渡しとして要件を明示します。難易度設計には、観測窓の設定、調整幅の制約、過調整回避、更新ルールの公開が必要です。観測窓が短すぎればノイズに振れ、長すぎれば追随が遅れます。制御設計として「追随性と安定性のトレードオフ」を意識する必要があります。[一次:S-CH07-001]

## 3. 調整ルール

難易度調整ルールは、過去区間の生成実績を参照し、次区間の課題難度を更新する手続きです。大切なのは、瞬間値で反応し過ぎないことです。短期ノイズをそのまま制御へ入れると、更新が過敏になり、かえって目標帯から離れることがあります。[一次:S-CH07-001]

日常導入として、空調の温度制御を考えます。センサー値へ即時・大幅反応すると、暑い寒いを行き来する振動が起きます。一定区間の平均で調整すると安定しやすくなります。難易度調整も同様に、単発変動より区間傾向を重視します。[一次:S-CH07-001]

素朴案1は「毎ブロックで大幅補正すれば早く追随できる」です。これは過調整を招きやすく、生成間隔が周期的に揺れます。素朴案2は「ほぼ補正しない」です。これは長期乖離を固定化し、利用遅延や安全余裕の偏りを増やします。調整ルールは、速さだけでも硬さだけでも成立しません。[一次:S-CH07-001]

破綻例として、調整幅を広げ過ぎたケースでは難易度が短周期で振動し、提案戦略の不安定化を招きます。逆に幅を狭め過ぎたケースでは、外部環境変化に追いつけず、目標生成間隔からの乖離が慢性化します。どちらも「理論上は動くが実務で扱いにくい」状態です。（要検証）

この破綻からの橋渡しは次の通りです。調整ルールの目的は未来の完全予測ではありません。目的は、逸脱時に復元する力を保つことです。復元力がある設計なら、外乱があっても長期的には目標帯へ戻せます。ここでの評価指標は「一時誤差の有無」より「誤差からの回復特性」です。[一次:S-CH07-001]

## 4. 攻撃耐性

PoWと難易度調整を統合した最終目的は、攻撃耐性の実効化です。ここでいう耐性はゼロリスク宣言ではなく、攻撃者の必要資源・時間・成功確率の組み合わせを不利にすることです。安全性主張は、常に条件付きで読む必要があります。[一次:S-CH07-001]

攻撃評価は二軸で行います。技術軸は、どれだけの再計算を要するか。経済軸は、その再計算コストが攻撃便益を上回るかです。技術軸だけを見ると「可能か不可能か」の二値へ寄り、経済軸だけを見ると実装制約を見落とします。両軸を同時に扱うことで、運用上の危険域を具体的に把握できます。[一次:S-CH07-001][一次:S-CH09-001]

具体例Aとして、短期的な価格変動で攻撃便益が一時上振れする局面を考えます。技術的ハードルが同じでも、経済軸の比率が変われば危険域へ近づきます。具体例Bとして、設備調達制約が強まり攻撃側の即時拡張が難しい局面を考えます。この場合、同じ便益でも実行可能性は下がります。いずれも時点依存で評価が変わります。（要検証）

ここで断定を避ける点を明示します。電力単価、設備供給、地理分散、運用停止率などは時期で変わるため、「現在の攻撃コスト」を固定値で一般化できません。数値を扱う主張は時点と出典を必ず添え、一般化する場合は範囲限定が必要です。（要検証）

次章への橋渡しを置きます。第8章では、ここでコスト重みが付いた履歴候補が、フォーク発生後にどう収束するかを扱います。第9章では、参加者が規則準拠行動を選び続ける条件を利得比較で扱います。第7章は、収束規則が機能するためのコスト地盤を作る章です。[一次:S-CH08-001][一次:S-CH09-001]

最後に結論を固定します。PoWの価値は、履歴改ざんへ計算コストを埋め込むことです。難易度調整の価値は、そのコスト水準を環境変化の中で保つことです。両者が揃って初めて、順序共有は「理論上の正しさ」から「運用上の実効性」へ進みます。[一次:S-CH07-001][一次:S-INTRO-001]

### 章内補足: PoW安全性を「条件付き主張」として運用する

PoWと難易度調整を実務で扱うとき、最も重要なのは「安全です」という断定を避け、どの条件でどの程度安全余裕があるかを条件文で管理することです。たとえば、同じ難易度水準でも、総計算能力の分布が偏っている局面と分散している局面では、実効的な攻撃難度が変わります。したがって難易度値そのものだけを見て安全性を語るのは不十分です。（要検証）

安全余裕を観測するための実務指標としては、少なくとも四つが必要です。第一は実観測の生成間隔分布です。平均だけでなく、短すぎる側と長すぎる側の偏りを見る必要があります。第二は分岐発生頻度です。分岐が増える局面では、同時発見や伝播遅延の影響が強まっている可能性があります。第三は難易度調整後の回復速度です。第四は提案主体の集中度です。これらを合わせて初めて、難易度制御が機能しているかを判断できます。（要検証）

ここで誤解しやすい点を整理します。誤解1は「難易度が上がれば常に安全性も上がる」です。難易度上昇は提案コストを上げますが、同時に参加障壁や可用性へ影響し得ます。誤解2は「生成間隔が目標通りなら問題ない」です。生成間隔が整っていても、提案主体集中や再編成頻度が悪化していれば、別軸のリスクが増えています。したがって安全性評価は単一指標で完結しません。[一次:S-CH07-001]

破綻例Aとして、難易度調整は追随しているが、外部ショックで一時的に攻撃便益が跳ね上がる局面を考えます。この場合、技術制御が正常でも経済軸で危険域へ入る可能性があります。破綻例Bとして、生成間隔は安定しているが分岐頻度が上がり、利用者側の確定待ちが長引く局面を考えます。この場合、仕様整合だけでは利用者体験を守れません。どちらも「制御が正常=実務安全」ではないことを示します。（要検証）

この破綻から導く運用要件は五つです。要件1は安全性主張の時点明示、要件2は前提条件の明示、要件3は監視指標の定期更新、要件4は閾値超過時の行動計画、要件5は結果の対外説明テンプレートです。特に要件4がないと、異常検知しても現場が止まります。観測は行動へ接続されて初めて意味を持ちます。（要検証）

さらに、PoW議論では「理論可能」と「実行可能」を分ける必要があります。理論可能性は数理的には広い集合を含みますが、実行可能性は時間制約、資源調達、監視反応、便益回収可能性で狭まります。安全性評価は、この二つを同じ文で混ぜないことが重要です。混ぜると、過度な楽観か過度な悲観のどちらかへ振れやすくなります。[一次:S-CH07-001][一次:S-CH09-001]

最後に、第7章補足のチェックリストを置きます。1) PoWの目的を「改ざんコスト化」として説明できるか。2) 難易度を「静的値」ではなく「制御量」として扱えているか。3) 調整ルールを追随性と安定性の両面で評価しているか。4) 技術軸と経済軸を分けて攻撃評価しているか。5) 異常検知後の行動手順を持っているか。これらが揃えば、PoWは神話でも悲観でもなく、条件付きで管理可能な安全性設計として扱えます。[一次:S-CH07-001][一次:S-CH08-001][一次:S-CH09-001]

補足の結論を固定します。PoW安全性の本質は、絶対安全の宣言ではなく、前提変動の中で攻撃成立条件を継続的に不利へ保つことです。難易度調整はそのための制御機構であり、観測・更新・説明を回してはじめて実効性を持ちます。[一次:S-CH07-001]

### 章内補足2: 難易度調整の読み違いを防ぐ

難易度調整でよく起きる読み違いは、「目標間隔に近い=安全」という短絡です。目標間隔は重要な運用指標ですが、安全性の十分条件ではありません。分岐頻度、再編成傾向、提案主体集中度などを同時に見てはじめて、実効的な安全余裕を判断できます。[一次:S-CH07-001][一次:S-CH08-001]

また、難易度調整の評価では「一時の乱れ」と「構造的な劣化」を分ける必要があります。一時乱れは外乱後に回復すれば問題が限定されます。構造劣化は回復せずに偏りが継続する状態です。両者を同じ文脈で語ると、過剰対策か過小対策のどちらかへ振れます。（要検証）

実務チェックとして、次の三点を置きます。1) 調整後の回復時間を継続記録しているか。2) 回復失敗時の暫定運用ルールを持っているか。3) 利用者向けに確定待ち方針を更新できるか。三点が揃うと、難易度調整は内部アルゴリズムで終わらず、外部運用へ接続されます。

第7章の最終確認一文は次です。「PoWは改ざんコストを課し、難易度調整はそのコスト水準を維持する」。この一文を言えれば、次章のフォーク収束と整合した読み方ができます。[一次:S-CH07-001]

### 章内補足3: 異常時の行動計画までをPoW設計に含める

PoWと難易度調整は、平常時の平均挙動だけでなく、異常時の行動計画まで含めて評価する必要があります。たとえば分岐急増や生成間隔急変を観測したとき、どの監視値を根拠に、どの暫定方針へ切り替えるかを定義しておくと、判断の遅れを減らせます。（要検証）

この観点では、技術設計書と運用手順書を分断しないことが重要です。技術側が異常を検知しても、運用側へ行動規則が渡っていなければ実効性は出ません。検知・判断・通知・復帰の四段を同じ時系列で設計することで、PoWの安全余裕は初めて業務品質へ変換されます。[一次:S-CH07-001]

本章の最終一文を再掲します。PoWは改ざんを不可能にするのではなく、条件付きで不利にし続ける設計です。この条件付きという認識を失わないことが、過信と過小評価の両方を避ける鍵です。[一次:S-CH07-001]

最終補足として、PoWと難易度調整は「固定ルール」ではなく「条件変化に追随する運用」を含めて評価してください。運用まで含めてこそ、改ざんコスト設計は実効性を持ちます。[一次:S-CH07-001]

追加補足として、難易度調整の評価では「戻る力」を必ず見てください。外乱の有無より、外乱後に目標帯へ戻れるかが制御品質を決めます。戻る力が弱い場合は、指標監視の周期短縮、閾値再設定、利用者向け待機方針の更新を同時に検討する必要があります。PoW安全性は計算理論だけでなく、復元運用まで含めて成立するという点を忘れないでください。[一次:S-CH07-001]

本章の最終補足です。難易度調整が機能しているかを判断する際は、単発の安定値ではなく、異常後に回復する一連の挙動を観測してください。回復が遅い、または振動が続く場合は、制御設計だけでなく運用通知の遅れも疑う必要があります。技術調整と運用調整を同時に回せる体制こそが、PoW安全性を実効化する最後の条件です。ここまで含めて「改ざんコストを維持する設計」と言えます。[一次:S-CH07-001]

最終補足として、PoW設計の評価は平常時性能だけで完了しません。異常後に安全余裕を回復できるか、回復状況を説明できるかまで含めて評価してください。ここまでを満たしてはじめて、難易度調整は実務上の防御機能になります。[一次:S-CH07-001]

最後に一つだけ固定します。PoWと難易度調整は、安全性を一度作って終える技術ではありません。観測・判断・更新を繰り返し、条件変化の中で安全余裕を維持し続けるための技術です。[一次:S-CH07-001]

終端を一段落で固定します。PoWと難易度調整は、一度安全性を作って終える技術ではなく、観測・判断・更新を繰り返して条件変化の中で安全余裕を維持する技術です。したがって第7章の実務基準は、平常時の安定値だけでなく、異常後の回復過程を説明可能に管理できることです。この動的維持を評価対象に入れてこそ、改ざんコスト設計は実効性を持ちます。[一次:S-CH07-001]

補足として、回復過程を追跡できる監視運用を設計に含めることが不可欠です。[一次:S-CH07-001]

この更新可能性まで含めて安全性を評価することが重要です。[一次:S-CH07-001]

補足として、異常検知後の判断遅延を減らす運用設計を必ず併設してください。[一次:S-CH07-001]

この実装運用一体の評価を第7章の標準として採用してください。[一次:S-CH07-001]
補記。[一次:S-CH07-001]

補足として、PoW評価では「回復時の運用切替」も確認が必要です。観測指標が悪化したとき、内部監視だけ強化して利用者向け方針を据え置くと、説明と実態が乖離します。逆に利用者向け告知だけ更新して内部閾値を据え置くと、過剰警戒が長期化します。したがって第7章の実務基準は、技術指標・内部運用・外部説明を同じ時系列で更新できることです。ここまで揃って初めて、条件変化の中で改ざんコスト設計を維持できます。[一次:S-CH07-001]
